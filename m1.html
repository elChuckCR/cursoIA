<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ingeniería de Prompts: Masterclass Interactiva + IA</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- FontAwesome (Icons) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Marked.js (Markdown Parser for AI Output) -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- Chosen Palette: "Chef's Kitchen" - Warm Neutrals, Paper Whites, and Burnt Sienna Accents -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        chef: {
                            50: '#fcfaf8',  // Base Canvas
                            100: '#f5f0eb', // Subtle Secondary
                            200: '#e6dcd3', // Borders
                            300: '#d6c8bc',
                            500: '#d97706', // Primary Accent (Sienna/Orange)
                            600: '#b45309', // Hover/Active
                            800: '#4a4036', // Text Primary
                            900: '#292524', // Headings
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                        mono: ['Fira Code', 'monospace'],
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>

    <!-- Application Structure Plan:
         The app follows the logical progression of the "Plan de estudio":
         1. HERO: Introduction & Metaphor (Chef) + 6-Week Roadmap Visual.
         2. FUNDAMENTALS (M1-M2): Interactive "Anatomy Dissector" to learn RTCE+FRE.
         3. THE COOKBOOK (M4): Filterable grid of 19 formulas. 
            * INTERACTION: Each card has a "✨ Demo IA" button calling Gemini to generate a live example.
         4. AI LAB (SOUS-CHEF): A dedicated workspace to practice.
            * INTERACTION: User inputs a vague prompt -> Gemini rewrites it using RTCE structure.
         5. ADVANCED LOGIC (M6-M7): Visual representation of Chain-of-Thought & ReAct patterns.
         6. EVALUATION (M8): Interactive Radar Chart comparing vague vs. engineered prompt quality.
         7. QUICK WINS (M10): Copy-paste templates for immediate value.
         
         WHY: This structure moves from concept (Mindset) to tool (Formulas) to application (Lab) to analysis (Evaluation).
    -->

    <!-- Visualization & Content Choices:
         - Roadmap: CSS Flex steps to visualize the learning path.
         - Anatomy Tool: Interactive text highlighting (DOM manipulation) to demystify prompt structure.
         - Formula Grid: Dynamic JS generation with category filtering.
         - Quality Radar: Chart.js to quantify the qualitative improvement of engineering.
         - AI Integration: Async fetch calls to Gemini API with loading states and Markdown rendering.
    -->

    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #fcfaf8;
            color: #292524;
        }
        
        /* Chart Container Styling (Mandatory) */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }

        /* Interactive Highlights */
        .highlight-btn.active {
            background-color: #d97706; 
            color: white;
            border-color: #d97706;
        }
        .anatomy-highlight {
            transition: all 0.3s ease;
            padding: 2px 4px;
            border-radius: 4px;
        }

        /* Typography & Scrollbar */
        .prose p { margin-bottom: 0.5em; }
        .prose ul { list-style-type: disc; padding-left: 1.2em; margin-bottom: 0.5em; }
        .prose strong { color: #b45309; }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f5f0eb; }
        ::-webkit-scrollbar-thumb { background: #d6d3d1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #a8a29e; }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <!-- Navigation -->
    <nav class="bg-white shadow-sm sticky top-0 z-50 border-b border-chef-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center cursor-pointer" onclick="window.scrollTo(0,0)">
                    <div class="w-8 h-8 bg-chef-500 rounded-lg flex items-center justify-center text-white mr-3 shadow-sm">
                        <i class="fa-solid fa-hat-chef"></i>
                    </div>
                    <span class="font-bold text-lg md:text-xl text-chef-900 tracking-tight">
                        Prompt<span class="text-chef-500">Mastery</span>
                        <span class="hidden sm:inline-block text-xs font-normal text-gray-500 ml-2 bg-gray-100 px-2 py-0.5 rounded-full border border-gray-200">
                            <i class="fa-solid fa-bolt text-yellow-500 text-[10px] mr-1"></i>Gemini Powered
                        </span>
                    </span>
                </div>
                <!-- Desktop Nav -->
                <div class="hidden md:flex items-center space-x-1">
                    <button onclick="scrollToSection('fundamentos')" class="px-3 py-2 text-sm font-medium text-chef-800 hover:text-chef-600 rounded-md hover:bg-chef-50 transition-colors">Fundamentos</button>
                    <button onclick="scrollToSection('recetario')" class="px-3 py-2 text-sm font-medium text-chef-800 hover:text-chef-600 rounded-md hover:bg-chef-50 transition-colors">Recetario</button>
                    <button onclick="scrollToSection('laboratorio')" class="ml-2 px-4 py-2 text-sm font-bold text-white bg-chef-900 hover:bg-chef-600 rounded-full shadow-md transition-all flex items-center gap-2">
                        <i class="fa-solid fa-wand-magic-sparkles text-yellow-400"></i> Lab IA
                    </button>
                    <button onclick="scrollToSection('logica')" class="px-3 py-2 text-sm font-medium text-chef-800 hover:text-chef-600 rounded-md hover:bg-chef-50 transition-colors">Lógica</button>
                    <button onclick="scrollToSection('evaluacion')" class="px-3 py-2 text-sm font-medium text-chef-800 hover:text-chef-600 rounded-md hover:bg-chef-50 transition-colors">Calidad</button>
                </div>
                <!-- Mobile Menu Icon -->
                <div class="md:hidden flex items-center">
                    <button class="text-chef-800 hover:text-chef-600 p-2">
                        <i class="fa-solid fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <main class="flex-grow">
        
        <!-- HERO SECTION: Metaphor & Roadmap -->
        <section class="bg-chef-100 border-b border-chef-200 py-12 md:py-20 relative overflow-hidden">
            <!-- Background Decoration -->
            <div class="absolute top-0 right-0 opacity-5 text-chef-900 text-[300px] leading-none -mr-20 -mt-20 select-none pointer-events-none">
                <i class="fa-solid fa-quote-right"></i>
            </div>

            <div class="max-w-5xl mx-auto px-4 text-center relative z-10">
                <div class="inline-block bg-white border border-chef-200 rounded-full px-3 py-1 text-xs font-bold text-chef-600 mb-6 shadow-sm animate-fade-in-up">
                    Plan de Estudio: 6 Semanas
                </div>
                <h1 class="text-4xl md:text-6xl font-extrabold text-chef-900 mb-6 tracking-tight">
                    No pidas "algo rico".<br>
                    <span class="text-transparent bg-clip-text bg-gradient-to-r from-chef-600 to-yellow-600">Pide la Receta Perfecta.</span>
                </h1>
                <p class="text-lg md:text-xl text-chef-800 max-w-2xl mx-auto mb-10 leading-relaxed">
                    La Ingeniería de Prompts es como dar instrucciones a un chef estrella. 
                    Si eres ambiguo, obtendrás "comida rápida". Si eres preciso (RTCE), obtendrás una obra maestra.
                    Este dashboard interactivo te guiará de novato a experto.
                </p>
                
                <!-- Roadmap Visualization -->
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-chef-200 max-w-4xl mx-auto">
                    <div class="grid grid-cols-2 md:grid-cols-6 gap-4">
                        <div class="bg-chef-50 p-3 rounded-xl border border-chef-100 flex flex-col items-center justify-center text-center">
                            <span class="text-xs font-bold text-chef-400 uppercase">Sem 1</span>
                            <span class="text-sm font-bold text-chef-900">Mentalidad</span>
                            <i class="fa-solid fa-brain text-chef-300 mt-2 text-lg"></i>
                        </div>
                        <div class="bg-chef-50 p-3 rounded-xl border border-chef-100 flex flex-col items-center justify-center text-center">
                            <span class="text-xs font-bold text-chef-400 uppercase">Sem 2</span>
                            <span class="text-sm font-bold text-chef-900">Estructura</span>
                            <i class="fa-solid fa-layer-group text-chef-300 mt-2 text-lg"></i>
                        </div>
                        <div class="bg-gradient-to-br from-chef-500 to-chef-600 p-3 rounded-xl shadow-lg transform md:-translate-y-2 flex flex-col items-center justify-center text-center text-white ring-4 ring-white">
                            <span class="text-xs font-bold text-yellow-200 uppercase">Sem 3-4</span>
                            <span class="text-sm font-bold">19 Fórmulas</span>
                            <i class="fa-solid fa-wand-magic-sparkles text-yellow-300 mt-2 text-lg animate-pulse"></i>
                        </div>
                        <div class="bg-chef-50 p-3 rounded-xl border border-chef-100 flex flex-col items-center justify-center text-center">
                            <span class="text-xs font-bold text-chef-400 uppercase">Sem 5</span>
                            <span class="text-sm font-bold text-chef-900">Contexto</span>
                            <i class="fa-solid fa-book-open text-chef-300 mt-2 text-lg"></i>
                        </div>
                        <div class="bg-chef-50 p-3 rounded-xl border border-chef-100 flex flex-col items-center justify-center text-center">
                            <span class="text-xs font-bold text-chef-400 uppercase">Sem 6</span>
                            <span class="text-sm font-bold text-chef-900">Lógica</span>
                            <i class="fa-solid fa-network-wired text-chef-300 mt-2 text-lg"></i>
                        </div>
                        <div class="bg-chef-900 p-3 rounded-xl border border-chef-800 flex flex-col items-center justify-center text-center text-white">
                            <span class="text-xs font-bold text-gray-400 uppercase">Meta</span>
                            <span class="text-sm font-bold">Librería</span>
                            <i class="fa-solid fa-box-archive text-gray-400 mt-2 text-lg"></i>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 1: ANATOMY (Fundamentals) -->
        <section id="fundamentos" class="py-16 md:py-24 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-12">
                <!-- Context Text -->
                <div class="lg:col-span-4">
                    <span class="text-chef-500 font-bold tracking-wider text-xs uppercase mb-2 block">Módulo 1-2: Fundamentos</span>
                    <h2 class="text-3xl font-bold text-chef-900 mb-4">La Anatomía del Prompt</h2>
                    <p class="text-chef-800 mb-6 leading-relaxed">
                        Un prompt no es una oración, es un <strong>algoritmo</strong>. Para eliminar la ambigüedad, debes estructurarlo como una receta.
                        La fórmula maestra es <strong>RTCE + FRE</strong>.
                    </p>
                    <div class="bg-white rounded-xl shadow-sm border border-chef-200 p-6">
                        <h3 class="font-bold text-chef-900 mb-4 text-sm flex items-center">
                            <i class="fa-solid fa-list-check text-chef-500 mr-2"></i> Desglosa el Prompt:
                        </h3>
                        <div id="anatomy-controls" class="space-y-2">
                            <!-- JS will populate buttons here -->
                        </div>
                    </div>
                </div>

                <!-- Interactive Viz -->
                <div class="lg:col-span-8">
                    <div class="bg-chef-900 rounded-2xl shadow-xl p-8 md:p-10 relative overflow-hidden min-h-[400px] flex flex-col justify-center">
                        <div class="absolute top-0 right-0 p-4 opacity-10">
                            <i class="fa-solid fa-terminal text-white text-8xl"></i>
                        </div>
                        <div class="font-mono text-lg md:text-xl text-gray-300 leading-loose relative z-10" id="prompt-display">
                            <!-- JS will populate text here -->
                        </div>
                        <div class="mt-8 pt-6 border-t border-gray-700 flex justify-between items-center text-xs text-gray-500 font-mono">
                            <span>Tokens estimados: 45</span>
                            <span>Modelo: Gemini 2.5</span>
                        </div>
                    </div>
                    <p class="text-center text-sm text-chef-500 mt-4 font-medium italic">
                        <i class="fa-solid fa-mouse-pointer mr-1"></i> Haz clic en los botones de la izquierda para iluminar la estructura.
                    </p>
                </div>
            </div>
        </section>

        <!-- SECTION 2: THE COOKBOOK (Formulas + AI Demo) -->
        <section id="recetario" class="py-16 bg-white border-y border-chef-200">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center max-w-3xl mx-auto mb-12">
                    <span class="text-chef-500 font-bold tracking-wider text-xs uppercase mb-2 block">Módulo 4: El Recetario</span>
                    <h2 class="text-3xl md:text-4xl font-bold text-chef-900 mb-4">19 Fórmulas Maestras</h2>
                    <p class="text-chef-800 text-lg">
                        No reinventes la rueda. Estas fórmulas son plantillas probadas para cada situación.
                        ¿No entiendes alguna? Usa el botón <strong>Demo IA</strong> para ver un ejemplo en vivo.
                    </p>
                </div>

                <!-- Filters -->
                <div class="flex flex-wrap justify-center gap-2 mb-10">
                    <button class="filter-btn active bg-chef-900 text-white px-5 py-2 rounded-full text-sm font-bold transition-all shadow-md hover:shadow-lg" data-filter="all">Todas</button>
                    <button class="filter-btn bg-chef-50 text-chef-600 border border-chef-200 px-5 py-2 rounded-full text-sm font-medium hover:bg-chef-100 transition-all" data-filter="Basico">Básicas</button>
                    <button class="filter-btn bg-chef-50 text-chef-600 border border-chef-200 px-5 py-2 rounded-full text-sm font-medium hover:bg-chef-100 transition-all" data-filter="Marketing">Marketing</button>
                    <button class="filter-btn bg-chef-50 text-chef-600 border border-chef-200 px-5 py-2 rounded-full text-sm font-medium hover:bg-chef-100 transition-all" data-filter="Analitico">Analítico</button>
                    <button class="filter-btn bg-chef-50 text-chef-600 border border-chef-200 px-5 py-2 rounded-full text-sm font-medium hover:bg-chef-100 transition-all" data-filter="Avanzado">Avanzado</button>
                </div>

                <!-- Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="formulas-grid">
                    <!-- Cards injected via JS -->
                </div>
            </div>
        </section>

        <!-- SECTION 3: AI LAB (Optimizer) -->
        <section id="laboratorio" class="py-16 md:py-24 bg-gradient-to-br from-chef-50 to-orange-50 relative">
            <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
                <div class="text-center mb-10">
                    <div class="inline-flex items-center justify-center w-16 h-16 bg-white rounded-full shadow-md mb-4 animate-bounce">
                        <i class="fa-solid fa-wand-magic-sparkles text-3xl text-chef-500"></i>
                    </div>
                    <h2 class="text-3xl md:text-4xl font-bold text-chef-900 mb-3">Laboratorio "Sous-Chef"</h2>
                    <p class="text-lg text-chef-800">
                        ¿Tienes un prompt perezoso? Escríbelo abajo y deja que nuestra IA lo reestructure siguiendo la metodología RTCE + FRE.
                    </p>
                </div>

                <div class="bg-white rounded-2xl shadow-xl border border-chef-200 overflow-hidden flex flex-col md:flex-row min-h-[500px]">
                    <!-- Input -->
                    <div class="w-full md:w-1/2 p-6 md:p-8 border-b md:border-b-0 md:border-r border-chef-100 flex flex-col">
                        <label class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-2">Entrada (Prompt Vago)</label>
                        <textarea id="ai-input" class="flex-grow w-full p-4 bg-gray-50 rounded-xl border border-gray-200 focus:border-chef-500 focus:ring-2 focus:ring-chef-100 outline-none resize-none transition-all text-chef-900 placeholder-gray-400 font-sans" placeholder="Ej: Escribe un correo para cancelar la reunión de mañana porque estoy enfermo..."></textarea>
                        
                        <div class="mt-6 flex justify-between items-center">
                            <span class="text-xs text-gray-400"><i class="fa-brands fa-google mr-1"></i>Gemini Flash 2.5</span>
                            <button onclick="optimizePrompt()" id="btn-optimize" class="bg-chef-900 hover:bg-chef-700 text-white px-6 py-3 rounded-lg font-bold shadow-lg hover:shadow-xl transition-all transform active:scale-95 flex items-center gap-2">
                                Optimizar <i class="fa-solid fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Output -->
                    <div class="w-full md:w-1/2 p-6 md:p-8 bg-chef-50 relative flex flex-col">
                        <label class="text-xs font-bold text-chef-500 uppercase tracking-wider mb-2">Salida (Prompt Ingeniero)</label>
                        
                        <div id="ai-output" class="flex-grow w-full overflow-y-auto prose prose-sm prose-orange text-chef-800 custom-scrollbar">
                            <!-- Empty State -->
                            <div class="h-full flex flex-col items-center justify-center text-gray-400 italic">
                                <i class="fa-regular fa-clipboard text-4xl mb-3 opacity-20"></i>
                                <p>El resultado aparecerá aquí.</p>
                            </div>
                        </div>

                        <!-- Loading Overlay -->
                        <div id="ai-loading" class="hidden absolute inset-0 bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center z-20">
                            <div class="w-12 h-12 border-4 border-chef-200 border-t-chef-600 rounded-full animate-spin mb-3"></div>
                            <span class="text-chef-600 font-bold animate-pulse">Cocinando Prompt...</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 4: LOGIC (Advanced) -->
        <section id="logica" class="py-16 bg-white border-y border-chef-200">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
                    <div>
                        <span class="text-chef-500 font-bold tracking-wider text-xs uppercase mb-2 block">Módulo 6: Razonamiento Avanzado</span>
                        <h2 class="text-3xl font-bold text-chef-900 mb-6">Chain of Thought (CoT) y ReAct</h2>
                        <p class="text-chef-800 mb-6 leading-relaxed">
                            Para problemas complejos, no pidas solo la respuesta. Pide el <strong>proceso</strong>. 
                            La técnica <strong>ReAct</strong> (Reasoning + Acting) obliga al modelo a "pensar en voz alta" antes de decidir, reduciendo alucinaciones drásticamente.
                        </p>
                        
                        <div class="space-y-4">
                            <div class="bg-red-50 p-4 rounded-lg border-l-4 border-red-400">
                                <h4 class="font-bold text-red-900 text-sm mb-1"><i class="fa-solid fa-xmark mr-2"></i>Prompt Estándar</h4>
                                <p class="text-sm text-red-800 italic">"Prioriza estos 10 riesgos del proyecto."</p>
                                <p class="text-xs text-red-600 mt-2">Result: Lista aleatoria o basada en sesgos simples.</p>
                            </div>
                            <div class="bg-green-50 p-4 rounded-lg border-l-4 border-green-500 shadow-md">
                                <h4 class="font-bold text-green-900 text-sm mb-1"><i class="fa-solid fa-check mr-2"></i>Prompt CoT</h4>
                                <p class="text-sm text-green-800 italic">"Analiza paso a paso el impacto y probabilidad de cada riesgo. Calcula el score y luego ordena."</p>
                                <p class="text-xs text-green-600 mt-2">Result: Tabla lógica y justificada.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Flow Visualization -->
                    <div class="relative">
                        <div class="absolute inset-0 bg-chef-100 transform rotate-3 rounded-3xl -z-10"></div>
                        <div class="bg-white p-8 rounded-2xl shadow-lg border border-chef-200 z-10">
                            <h3 class="text-center font-bold text-chef-800 mb-6 uppercase text-sm tracking-widest">El Ciclo ReAct</h3>
                            <div class="flex flex-col space-y-4 relative">
                                <!-- Connector Line -->
                                <div class="absolute left-8 top-8 bottom-8 w-0.5 bg-gray-200 -z-10"></div>

                                <!-- Step 1 -->
                                <div class="flex items-start">
                                    <div class="w-16 h-16 rounded-full bg-white border-2 border-gray-300 flex items-center justify-center shrink-0 z-10 text-gray-400 font-bold shadow-sm">
                                        IN
                                    </div>
                                    <div class="ml-4 bg-gray-50 p-3 rounded-lg border border-gray-200 w-full">
                                        <span class="text-xs font-bold text-gray-500 block">Input</span>
                                        <p class="text-sm text-gray-800">"¿Debemos lanzar la feature X?"</p>
                                    </div>
                                </div>

                                <!-- Step 2 -->
                                <div class="flex items-start">
                                    <div class="w-16 h-16 rounded-full bg-yellow-100 border-2 border-yellow-400 flex items-center justify-center shrink-0 z-10 text-yellow-600 text-xl shadow-sm">
                                        <i class="fa-regular fa-lightbulb"></i>
                                    </div>
                                    <div class="ml-4 bg-yellow-50 p-3 rounded-lg border border-yellow-200 w-full">
                                        <span class="text-xs font-bold text-yellow-700 block">Thought (Razonamiento)</span>
                                        <p class="text-sm text-gray-800 italic">"Necesito revisar los KPIs de Q1 y el feedback de beta testers..."</p>
                                    </div>
                                </div>

                                <!-- Step 3 -->
                                <div class="flex items-start">
                                    <div class="w-16 h-16 rounded-full bg-blue-100 border-2 border-blue-400 flex items-center justify-center shrink-0 z-10 text-blue-600 text-xl shadow-sm">
                                        <i class="fa-solid fa-gears"></i>
                                    </div>
                                    <div class="ml-4 bg-blue-50 p-3 rounded-lg border border-blue-200 w-full">
                                        <span class="text-xs font-bold text-blue-700 block">Action (Herramienta/Cálculo)</span>
                                        <p class="text-sm text-gray-800 font-mono">search_docs("beta_feedback")</p>
                                    </div>
                                </div>

                                <!-- Step 4 -->
                                <div class="flex items-start">
                                    <div class="w-16 h-16 rounded-full bg-green-100 border-2 border-green-500 flex items-center justify-center shrink-0 z-10 text-green-600 text-xl shadow-sm">
                                        <i class="fa-solid fa-flag-checkered"></i>
                                    </div>
                                    <div class="ml-4 bg-green-50 p-3 rounded-lg border border-green-200 w-full">
                                        <span class="text-xs font-bold text-green-700 block">Observation (Salida)</span>
                                        <p class="text-sm text-gray-800 font-bold">Recomendación: Retrasar lanzamiento.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 5: EVALUATION (Radar Chart) -->
        <section id="evaluacion" class="py-16 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-10">
                <span class="text-chef-500 font-bold tracking-wider text-xs uppercase mb-2 block">Módulo 8: Auditoría de Calidad</span>
                <h2 class="text-3xl font-bold text-chef-900">La Diferencia es Cuantificable</h2>
                <p class="text-chef-800 max-w-2xl mx-auto mt-2">
                    Usando la rúbrica del curso, podemos medir objetivamente por qué un prompt estructurado vence a uno vago.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 items-center bg-white p-8 rounded-2xl shadow-sm border border-chef-200">
                <!-- Controls -->
                <div class="md:col-span-1 space-y-4">
                    <button onclick="updateChart('vago')" class="w-full p-4 rounded-xl border-2 border-transparent hover:bg-red-50 transition-all bg-gray-50 group text-left focus:ring-2 focus:ring-red-200">
                        <div class="flex items-center justify-between mb-2">
                            <span class="font-bold text-gray-700 group-hover:text-red-700">Enfoque Vago</span>
                            <i class="fa-solid fa-circle-xmark text-gray-300 group-hover:text-red-500 text-xl"></i>
                        </div>
                        <p class="text-xs text-gray-500 italic">"Haz un resumen."</p>
                    </button>

                    <button onclick="updateChart('ingeniero')" class="w-full p-4 rounded-xl border-2 border-chef-500 bg-chef-50 shadow-md text-left relative overflow-hidden group">
                        <div class="absolute top-0 right-0 bg-chef-500 text-white text-[10px] font-bold px-2 py-1 rounded-bl">WINNER</div>
                        <div class="flex items-center justify-between mb-2">
                            <span class="font-bold text-chef-900">Enfoque Ingeniero</span>
                            <i class="fa-solid fa-circle-check text-chef-600 text-xl"></i>
                        </div>
                        <p class="text-xs text-chef-700 italic">"Rol: PM. Contexto: Comité..."</p>
                    </button>
                </div>

                <!-- Chart -->
                <div class="md:col-span-2 flex justify-center">
                    <div class="chart-container">
                        <canvas id="qualityChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 6: QUICK WINS -->
        <section class="py-16 bg-chef-900 text-white">
            <div class="max-w-6xl mx-auto px-4">
                <h2 class="text-3xl font-bold mb-8 text-center">Quick Wins: Copiar y Pegar</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- Win 1 -->
                    <div class="bg-chef-800 p-6 rounded-xl border border-chef-700 hover:border-chef-500 transition-colors group">
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 rounded-full bg-chef-700 flex items-center justify-center mr-3 group-hover:bg-chef-600 transition-colors">
                                <i class="fa-solid fa-envelope text-white"></i>
                            </div>
                            <h3 class="font-bold text-lg">Correo "Difícil"</h3>
                        </div>
                        <div class="bg-black/30 p-3 rounded font-mono text-xs text-gray-300 select-all cursor-text mb-2">
                            Rol: PM. Contexto: Retraso 2 semanas. Tono: Responsable pero firme. Formato: 3 opciones.
                        </div>
                        <p class="text-xs text-gray-400">Usa fórmula RACE.</p>
                    </div>
                    <!-- Win 2 -->
                    <div class="bg-chef-800 p-6 rounded-xl border border-chef-700 hover:border-chef-500 transition-colors group">
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 rounded-full bg-chef-700 flex items-center justify-center mr-3 group-hover:bg-chef-600 transition-colors">
                                <i class="fa-solid fa-file-contract text-white"></i>
                            </div>
                            <h3 class="font-bold text-lg">Acta a JSON</h3>
                        </div>
                        <div class="bg-black/30 p-3 rounded font-mono text-xs text-gray-300 select-all cursor-text mb-2">
                            Input: Transcript. Tarea: Extraer acuerdos. Formato: JSON {acuerdo, dueño, fecha}.
                        </div>
                        <p class="text-xs text-gray-400">Automatización.</p>
                    </div>
                    <!-- Win 3 -->
                    <div class="bg-chef-800 p-6 rounded-xl border border-chef-700 hover:border-chef-500 transition-colors group">
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 rounded-full bg-chef-700 flex items-center justify-center mr-3 group-hover:bg-chef-600 transition-colors">
                                <i class="fa-solid fa-list-ol text-white"></i>
                            </div>
                            <h3 class="font-bold text-lg">Priorización</h3>
                        </div>
                        <div class="bg-black/30 p-3 rounded font-mono text-xs text-gray-300 select-all cursor-text mb-2">
                            Tarea: Calcular RICE score. Pasos: 1. Estima Reach. 2. Estima Impact... Output: Tabla.
                        </div>
                        <p class="text-xs text-gray-400">Usa Chain of Thought.</p>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-chef-200 py-10">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <div class="flex justify-center items-center mb-4 text-chef-900 font-bold text-xl">
                <i class="fa-solid fa-hat-chef mr-2"></i> PromptMastery
            </div>
            <p class="text-chef-600 mb-6 text-sm">Basado en el "Plan de estudio por módulos para dominar Ingeniería de Prompts"</p>
            
            <div class="inline-flex flex-wrap justify-center gap-4 text-sm text-chef-500 font-medium">
                <span class="flex items-center"><i class="fa-solid fa-check-circle mr-1 text-green-500"></i> Define tu Rol</span>
                <span class="flex items-center"><i class="fa-solid fa-check-circle mr-1 text-green-500"></i> Fija Restricciones</span>
                <span class="flex items-center"><i class="fa-solid fa-check-circle mr-1 text-green-500"></i> Valida la Salida</span>
            </div>
        </div>
    </footer>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- 1. GEMINI API CONFIGURATION ---
        const apiKey = ""; // Runtime environment handles this
        
        async function callGemini(promptText) {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            const payload = {
                contents: [{ parts: [{ text: promptText }] }]
            };

            // Retry logic with exponential backoff
            const delays = [1000, 2000, 4000];
            for (let i = 0; i <= delays.length; i++) {
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) throw new Error(`HTTP ${response.status}`);
                    
                    const data = await response.json();
                    return data.candidates?.[0]?.content?.parts?.[0]?.text || "No se pudo generar respuesta.";
                    
                } catch (error) {
                    if (i === delays.length) throw error;
                    await new Promise(resolve => setTimeout(resolve, delays[i]));
                }
            }
        }

        // --- 2. AI FEATURE: OPTIMIZER (SOUS-CHEF) ---
        async function optimizePrompt() {
            const input = document.getElementById('ai-input').value;
            const outputDiv = document.getElementById('ai-output');
            const loadingDiv = document.getElementById('ai-loading');
            const btn = document.getElementById('btn-optimize');

            if (!input.trim()) {
                outputDiv.innerHTML = '<div class="h-full flex flex-col items-center justify-center text-red-400 italic"><i class="fa-solid fa-triangle-exclamation text-2xl mb-2"></i><p>Escribe un prompt primero.</p></div>';
                return;
            }

            loadingDiv.classList.remove('hidden');
            btn.disabled = true;
            btn.classList.add('opacity-50', 'cursor-not-allowed');

            const systemPrompt = `
                Actúa como un Ingeniero de Prompts Experto y Pedagógico.
                Transforma el siguiente prompt vago del usuario en un "Prompt Maestro" siguiendo la estructura RTCE + FRE.
                
                Input del Usuario: "${input}"
                
                Tu Salida debe ser en Markdown:
                1. **Análisis Rápido:** Una frase sobre qué faltaba en el original.
                2. **Prompt Optimizado:** Un bloque de código con el prompt listo, definiendo claramente:
                   - **Rol:** ...
                   - **Tarea:** ...
                   - **Contexto:** ...
                   - **Formato:** ...
                   - **Restricciones:** ...
                   - **Evaluación:** ...
                
                Mantén el idioma español.
            `;

            try {
                const result = await callGemini(systemPrompt);
                outputDiv.innerHTML = marked.parse(result);
            } catch (error) {
                outputDiv.innerHTML = `<p class="text-red-500">Error de conexión: ${error.message}</p>`;
            } finally {
                loadingDiv.classList.add('hidden');
                btn.disabled = false;
                btn.classList.remove('opacity-50', 'cursor-not-allowed');
            }
        }

        // --- 3. AI FEATURE: FORMULA DEMO GENERATOR ---
        async function generateExample(formulaCode, formulaName, btnId) {
            const btn = document.getElementById(btnId);
            const card = document.getElementById(`card-${btnId}`);
            const originalHTML = btn.innerHTML;
            
            btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Generando...';
            btn.disabled = true;
            btn.classList.remove('bg-white', 'text-chef-600');
            btn.classList.add('bg-chef-100', 'text-chef-800');

            const prompt = `
                Actúa como Instructor de Prompting.
                Genera un ejemplo breve y práctico (menos de 40 palabras) usando la fórmula: "${formulaName}" (${formulaCode}).
                Tema: Entorno corporativo o productividad.
                Formato: Solo el texto del prompt ejemplo.
            `;

            try {
                const result = await callGemini(prompt);
                
                // Clear previous example if any
                const existing = card.querySelector('.ai-example');
                if(existing) existing.remove();

                const div = document.createElement('div');
                div.className = 'ai-example mt-3 p-3 bg-chef-50 rounded-lg border border-chef-200 text-xs font-mono text-chef-800 animate-pulse-once';
                div.innerHTML = `<strong class="text-chef-500 block mb-1 text-[10px] uppercase">✨ Ejemplo Generado:</strong>${marked.parse(result)}`;
                
                // Style cleanups for markdown output
                const p = div.querySelector('p');
                if(p) p.style.marginBottom = '0';
                
                // Insert before the button
                btn.parentNode.insertBefore(div, btn);
                
            } catch (error) {
                alert("Error al generar ejemplo.");
            } finally {
                btn.innerHTML = originalHTML;
                btn.disabled = false;
                btn.classList.add('bg-white', 'text-chef-600');
                btn.classList.remove('bg-chef-100', 'text-chef-800');
            }
        }

        // --- 4. ANATOMY INTERACTION DATA ---
        const anatomyData = [
            { id: 'rol', label: 'Rol (R)', text: 'Actúa como PM Senior.', color: 'bg-blue-500' },
            { id: 'tarea', label: 'Tarea (T)', text: 'Quiero un resumen ejecutivo de este texto', color: 'bg-green-500' },
            { id: 'restriccion', label: 'Restricciones (R)', text: 'en 100–120 palabras', color: 'bg-red-500' },
            { id: 'estilo', label: 'Estilo', text: 'tono directivo', color: 'bg-purple-500' },
            { id: 'contexto', label: 'Contexto (C)', text: 'resalta 3 riesgos con probabilidad/impacto y acciones.', color: 'bg-yellow-600' },
            { id: 'formato', label: 'Formato (F)', text: 'Formato: tabla Markdown.', color: 'bg-pink-500' }
        ];
        
        const anatomyFullText = "Actúa como PM Senior. Quiero un resumen ejecutivo de este texto en 100–120 palabras, tono directivo, resalta 3 riesgos con probabilidad/impacto y acciones. Formato: tabla Markdown.";

        function renderAnatomy() {
            const controls = document.getElementById('anatomy-controls');
            const display = document.getElementById('prompt-display');
            
            // Render Text with Spans
            let html = anatomyFullText;
            anatomyData.forEach(part => {
                html = html.replace(part.text, `<span id="span-${part.id}" class="anatomy-highlight border-b-2 border-gray-700 pb-0.5 transition-colors duration-300 cursor-help opacity-60 hover:opacity-100">${part.text}</span>`);
            });
            display.innerHTML = html;

            // Render Buttons
            controls.innerHTML = '';
            anatomyData.forEach(part => {
                const btn = document.createElement('button');
                btn.className = 'highlight-btn w-full text-left px-4 py-3 rounded-lg border border-chef-100 bg-chef-50 hover:bg-white transition-all font-medium text-chef-800 text-sm flex justify-between items-center group';
                btn.onclick = () => toggleAnatomy(part.id, part.color, btn);
                btn.innerHTML = `
                    <span class="group-hover:translate-x-1 transition-transform">${part.label}</span>
                    <div class="w-3 h-3 rounded-full ${part.color} shadow-sm"></div>
                `;
                controls.appendChild(btn);
            });
        }

        function toggleAnatomy(id, colorClass, btn) {
            // Reset all
            document.querySelectorAll('.anatomy-highlight').forEach(el => {
                el.style.backgroundColor = 'transparent';
                el.style.color = '#d1d5db'; // gray-300
                el.classList.remove('active');
            });
            document.querySelectorAll('.highlight-btn').forEach(b => {
                b.classList.remove('active', 'ring-2', 'ring-chef-500');
            });

            // Activate specific
            const span = document.getElementById(`span-${id}`);
            const colorMap = { 'bg-blue-500': '#3b82f6', 'bg-green-500': '#22c55e', 'bg-red-500': '#ef4444', 'bg-purple-500': '#a855f7', 'bg-yellow-600': '#ca8a04', 'bg-pink-500': '#ec4899' };
            
            span.style.backgroundColor = colorMap[colorClass];
            span.style.color = 'white';
            span.classList.add('active');
            
            btn.classList.add('active', 'ring-2', 'ring-chef-500');
        }

        // --- 5. FORMULAS DATA ---
        const formulas = [
            { code: "RTF", name: "Rol-Tarea-Formato", cat: "Basico", desc: "El estándar para velocidad.", template: "Eres [Rol]. Haz [Tarea]. Salida: [Formato]." },
            { code: "PECRA", name: "Persona-Ej-Context-Restr-Acción", cat: "Avanzado", desc: "Para enseñar con ejemplos (Few-Shot).", template: "Persona:.. Ejemplos:.. Contexto:.." },
            { code: "CREATE", name: "Context-Role-Ex-Audience-Task-Eval", cat: "Marketing", desc: "Para entregables creativos.", template: "Contexto:.. Audiencia:.. Tarea:.." },
            { code: "CRISPE", name: "Context-Role-Intent-Style-Persona-Ex", cat: "Marketing", desc: "Copywriting persuasivo.", template: "Intención: Persuadir. Estilo: Apple." },
            { code: "CLEAR", name: "Context-Length-Ex-Audience-Response", cat: "Basico", desc: "Estricto con la longitud.", template: "Longitud: 100 palabras." },
            { code: "SCORE", name: "Scope-Constraints-Output-Reasoning-Eval", cat: "Analitico", desc: "Resolución de problemas.", template: "Reasoning: Paso a paso." },
            { code: "GUIDE", name: "Goal-User-Input-Details-Eval", cat: "Analitico", desc: "Briefs de proyecto.", template: "Goal: Encontrar error. Details: 3 puntos." },
            { code: "RACE", name: "Rol-Audiencia-Contexto-Expectativas", cat: "Basico", desc: "Mensajes a stakeholders.", template: "Expectativas: Opciones A/B." },
            { code: "COAST", name: "Contexto-Objetivo-Acciones-Estilo-Tono", cat: "Basico", desc: "Planes de acción.", template: "Estilo: Operativo." },
            { code: "JSON", name: "JSON-First", cat: "Analitico", desc: "Integraciones.", template: "Responde SOLO JSON con esquema X." },
            { code: "CoT", name: "Chain of Thought", cat: "Avanzado", desc: "Lógica compleja.", template: "Piensa paso a paso y verifica." },
            { code: "ReAct", name: "Razonar + Actuar", cat: "Avanzado", desc: "Toma de decisiones.", template: "Razona, Actúa, Observa." },
            { code: "APE", name: "Aclarar-Proponer-Ejecutar", cat: "Basico", desc: "Requisitos vagos.", template: "Pregunta antes de ejecutar." },
            { code: "ICE", name: "Itera-Critica-Expande", cat: "Marketing", desc: "Creatividad.", template: "V1 -> Crítica -> V2." },
            { code: "LTM", name: "Least to Most", cat: "Avanzado", desc: "Problemas grandes.", template: "Divide en subproblemas." }
        ];

        function renderFormulas(filter) {
            const grid = document.getElementById('formulas-grid');
            grid.innerHTML = '';
            
            formulas.forEach((f, idx) => {
                if (filter !== 'all' && f.cat !== filter) return;

                const card = document.createElement('div');
                card.id = `card-btn-${idx}`;
                card.className = 'bg-white p-6 rounded-xl border border-chef-200 shadow-sm hover:shadow-lg transition-all flex flex-col h-full group';
                
                // Color coding tags
                let tagClass = 'bg-gray-100 text-gray-600';
                if(f.cat === 'Basico') tagClass = 'bg-blue-50 text-blue-600 border border-blue-100';
                if(f.cat === 'Marketing') tagClass = 'bg-purple-50 text-purple-600 border border-purple-100';
                if(f.cat === 'Analitico') tagClass = 'bg-green-50 text-green-600 border border-green-100';
                if(f.cat === 'Avanzado') tagClass = 'bg-orange-50 text-orange-600 border border-orange-100';

                card.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <h3 class="text-xl font-extrabold text-chef-900 tracking-tight">${f.code}</h3>
                        <span class="text-[10px] font-bold uppercase tracking-wider px-2 py-1 rounded-full ${tagClass}">${f.cat}</span>
                    </div>
                    <p class="text-sm font-bold text-chef-800 mb-1">${f.name}</p>
                    <p class="text-sm text-gray-500 mb-4 flex-grow">${f.desc}</p>
                    <div class="bg-gray-50 p-2 rounded border border-gray-100 mb-4">
                        <code class="text-xs text-chef-600 break-words font-mono">${f.template}</code>
                    </div>
                    <button id="btn-${idx}" onclick="generateExample('${f.code}', '${f.name}', 'btn-${idx}')" class="w-full py-2 bg-white border border-chef-200 text-chef-600 text-xs font-bold rounded-lg hover:bg-chef-50 transition-all flex items-center justify-center gap-2 shadow-sm group-hover:border-chef-300">
                        <i class="fa-solid fa-wand-magic-sparkles text-yellow-500"></i> Demo IA
                    </button>
                `;
                grid.appendChild(card);
            });
        }

        function setupFilters() {
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('.filter-btn').forEach(b => {
                        b.classList.remove('bg-chef-900', 'text-white', 'shadow-md');
                        b.classList.add('bg-chef-50', 'text-chef-600');
                    });
                    e.target.classList.remove('bg-chef-50', 'text-chef-600');
                    e.target.classList.add('bg-chef-900', 'text-white', 'shadow-md');
                    renderFormulas(e.target.dataset.filter);
                });
            });
        }

        // --- 6. CHART.JS LOGIC ---
        let qualityChart;

        function initChart() {
            const ctx = document.getElementById('qualityChart').getContext('2d');
            qualityChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Precisión', 'Claridad', 'Estructura', 'Accionabilidad', 'Tono'],
                    datasets: [{
                        label: 'Calidad del Prompt',
                        data: [2, 2, 1, 1, 2], // Default Vago
                        fill: true,
                        backgroundColor: 'rgba(239, 68, 68, 0.2)',
                        borderColor: 'rgb(239, 68, 68)',
                        pointBackgroundColor: 'rgb(239, 68, 68)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgb(239, 68, 68)'
                    }]
                },
                options: {
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            min: 0,
                            max: 5,
                            ticks: { stepSize: 1, display: false },
                            grid: { color: '#e5e7eb' },
                            pointLabels: {
                                font: { size: 12, family: "'Inter', sans-serif", weight: 'bold' },
                                color: '#4b5563'
                            },
                            angleLines: { color: '#e5e7eb' }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function updateChart(type) {
            const datasets = {
                'vago': {
                    data: [2, 2, 1, 1, 2],
                    bg: 'rgba(239, 68, 68, 0.2)',
                    border: 'rgb(239, 68, 68)'
                },
                'ingeniero': {
                    data: [5, 5, 5, 5, 4],
                    bg: 'rgba(217, 119, 6, 0.2)', // Chef Orange
                    border: 'rgb(217, 119, 6)'
                }
            };
            
            const selected = datasets[type];
            qualityChart.data.datasets[0].data = selected.data;
            qualityChart.data.datasets[0].backgroundColor = selected.bg;
            qualityChart.data.datasets[0].borderColor = selected.border;
            qualityChart.data.datasets[0].pointBackgroundColor = selected.border;
            qualityChart.data.datasets[0].pointHoverBorderColor = selected.border;
            qualityChart.update();
        }

        // --- 7. INITIALIZATION ---
        function scrollToSection(id) {
            const el = document.getElementById(id);
            if(el) el.scrollIntoView({ behavior: 'smooth' });
        }

        document.addEventListener('DOMContentLoaded', () => {
            renderAnatomy();
            renderFormulas('all');
            setupFilters();
            initChart();
        });

    </script>
</body>
</html>
